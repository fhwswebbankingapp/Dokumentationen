<!DOCTYPE html><html><head>
      <title>Dokumentation Fabian Konrad</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///C:\Users\Fabian Konrad\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.3.11\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      

      <style> 
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
 
      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <h1 class="mume-header" id="dokumentation-der-von-fabian-konrad-durchgef%C3%BChrten-entwicklungen">Dokumentation der von Fabian Konrad durchgef&#xFC;hrten Entwicklungen</h1>

<h2 class="mume-header" id="1-a-nameinhaltsverzeichnisainhaltsverzeichnis">1. <a name="Inhaltsverzeichnis" href=""></a>Inhaltsverzeichnis</h2>

<ul>
<li>
<ol>
<li><a href="#Inhaltsverzeichnis">Inhaltsverzeichnis</a></li>
</ol>
</li>
<li>
<ol start="2">
<li><a href="#MotivationundZielsetzung">Motivation und Zielsetzung</a></li>
</ol>
</li>
<li>
<ol start="3">
<li><a href="#InstallationderPHP-Bibliothekenund-Dependencies">Installation der PHP-Bibliotheken und -Dependencies</a></li>
</ol>
</li>
<li>
<ol start="4">
<li><a href="#BenutzungvoncURL">Benutzung von cURL</a></li>
</ol>
</li>
<li>
<ol start="5">
<li><a href="#SicherheitundKonfigurationdesApache-Servers">Sicherheit und Konfiguration des Apache-Servers</a></li>
</ol>
</li>
<li>
<ol start="6">
<li><a href="#EntwicklungenaufdemServer">Entwicklungen auf dem Server</a></li>
</ol>
<ul>
<li>6.1. <a href="#Login">Login</a></li>
<li>6.2. <a href="#Registrierung">Registrierung</a></li>
<li>6.3. <a href="#GenerierungdesSharedSecrets">Generierung des Shared Secrets</a></li>
<li>6.4. <a href="#Passwort-Vergessen-Modus">Passwort-Vergessen-Modus</a></li>
<li>6.5. <a href="#AnpassungenanderDatenbank">Anpassungen an der Datenbank</a></li>
<li>6.6. <a href="#KommunikationmitderApp">Kommunikation mit der App</a></li>
</ul>
</li>
<li>
<ol start="7">
<li><a href="#EntwicklungdesMobileAgent">Entwicklung des Mobile Agent</a></li>
</ol>
<ul>
<li>7.1. <a href="#WahldesFrameworks">Wahl des Frameworks</a></li>
<li>7.2. <a href="#Das-Entry-Skript">Das-Entry-Skript</a></li>
<li>7.3. <a href="#DerHomeScreen">Der HomeScreen</a></li>
<li>7.4. <a href="#DieLogin-Page">Die Login-Page</a></li>
<li>7.5. <a href="#DerHomescreenfrangemeldeteUser">Der Homescreen f&#xFC;r angemeldete User</a></li>
<li>7.6. <a href="#BereitstellungeinesSharedSecretbereinenQR-Code-Scanner">Bereitstellung eines Shared Secret &#xFC;ber einen QR-Code-Scanner</a></li>
<li>7.7. <a href="#DieergnzendenSkripte">Die erg&#xE4;nzenden Skripte</a></li>
<li>7.8. <a href="#StartderApp">Start der App</a></li>
</ul>
</li>
<li>
<ol start="8">
<li><a href="#Funoten">Fu&#xDF;noten</a></li>
</ol>
</li>
</ul>
<h2 class="mume-header" id="2-a-namemotivationundzielsetzungamotivation-und-zielsetzung">2. <a name="MotivationundZielsetzung" href=""></a>Motivation und Zielsetzung</h2>

<p>F&#xFC;r diesen Teil war die prim&#xE4;re Zielsetzung, f&#xFC;r die gesamte Architektur eine sichere &#xDC;bertragung der Daten zu gew&#xE4;hrleisten. Dies beginnt bei der Auswahl der Technologie und endet bei der Gestaltung der verschiedenen User-Interaktionen. &#xDC;berall m&#xFC;ssen Komponenten eingebaut werden, die die Sicherheit der &#xDC;bertragung gew&#xE4;hrleisten. Es muss sichergestellt werden, dass kein User seine Bankdaten verliert, genauso wie sichergestellt werden muss, dass seine Daten nicht an Dritte weitergegeben werden k&#xF6;nnen. Beim Thema Sicherheit wurde also angestrebt, diese hoch zu halten, indem das Thema Asynchronit&#xE4;t hervorgehoben wurde: Ein Mensch kann innerhalb weniger Sekunden seinen Blick von einem Blatt Papier auf ein Handy und danach auf einen Computer werfen. W&#xE4;hrenddessen m&#xFC;ssen Computer oder Bots f&#xFC;r jedes einzelne Ger&#xE4;t zun&#xE4;chst die Adressen aufdecken, &#xFC;ber die sie erreichbar sind. Wenn es nun anschlie&#xDF;end um den Zugriff auf die Ger&#xE4;te geht, muss dieser vorher auf dem Computer oder Bot implementiert worden sein. Einen Zettel wird der Computer ohne die Hilfe eines Scanners erst recht nicht lesen k&#xF6;nnen.<br>
Die Sicherheit entsteht folglich dadurch, dass der Mensch technisch weitaus flexibler ist als die Software. Letztendlich bedeutet dies, dass man die h&#xF6;chste Sicherheit ganz einfach gew&#xE4;hrleisten kann, n&#xE4;mlich dann, wenn man Autorisierungen durch den User einfordert.<br>
Gerade beim Thema Geld ist eine Autorisierung ein &#xE4;u&#xDF;erst wichtiges Thema. Aus diesem Grund wurde eine Mobile App konzipiert, die sicherstellt, dass jede Zahlung, jede Transaktion und jede Handlung betreffend des User-Accounts durch einen menschlichen Klick auf einen Button genehmigt wird. So wird auf H&#xF6;chster Ebene sichergestellt, dass der Mensch, der das Online-Banking-Tool nutzen will, durch sein pers&#xF6;nliches Zutun bewiesen hat, dass er ein Mensch ist und kein Bot die wichtigsten User-daten abrufen kann.<br>
Die App unterst&#xFC;tzte au&#xDF;erdem eine weitere Zielsetzung, die Usability auf Mobilger&#xE4;ten zu erh&#xF6;hen. Seit Jahren w&#xE4;chst bereits der Trend bei der Web-Nutzung immer weiter in Richtung Mobilger&#xE4;t zu arbeiten und in meinem Fall auch zu entwickeln.<br>
Beim Teilgebiet Sicherheit konnte die Anforderung und Zielsetzung exakt definiert werden: Der Zugriff auf den Webserver muss verschl&#xFC;sselt erfolgen, den modernsten HTTPS-Standard einsetzen und soll auf einem Browser keine Fehler aufgrund falscher Zertifizierung generieren. Das Beziehen von Zertifikaten muss automatisch erfolgen. Die Einrichtung eines Domain Records ist optional. Zus&#xE4;tzlich soll die Kommunikation mit der App nicht aus Sicherheitsgr&#xFC;nden gesperrt werden.</p>
<h2 class="mume-header" id="3-a-nameinstallationderphp-bibliothekenund-dependenciesainstallation-der-php-bibliotheken-und-dependencies">3. <a name="InstallationderPHP-Bibliothekenund-Dependencies" href=""></a>Installation der PHP-Bibliotheken und -Dependencies</h2>

<p>Um die Entwicklung verschiedener Komponenten, wie dem Mailing-Dienst oder dem Push-Dienst einzurichten, war es n&#xF6;tig verschiedene Bibliotheken einzubinden. Auch der Datenaustausch sollte mit Hilfe von pecl_http, das wesentlich einfacher zu bedienen ist als cURL vereinfacht werden. Der prim&#xE4;re Versuch war es, PECL-Bibliotheken zu nutzen, vor allem die entsprechende PECL HTTP-Bibiliothek. PECL ist ein Repository f&#xFC;r verschiedene PHP-Komponenten, die jedoch im Gegensatz zu ordin&#xE4;ren PHP-Skripten vorkompiliert sind und im Falle von Windows als eine Dynamic Link Library(DLL) in das PHP-ext (ext steht f&#xFC;r hierbei f&#xFC;r Extensions, also Erweiterungen) gespeichert werden m&#xFC;ssen &#xFC;ber das php.ini-File eingebunden werden m&#xFC;ssen. Mit PECL bezieht man dementsprechend nur den Source Code, meistens in der Sprache C, den man anschlie&#xDF;end mit dem Visual-Studio-C-Compiler zu einer Bibliothek kompilieren muss. Leider war PECL nicht installiert und musste erst &#xFC;ber PEAR bezogen werden. PEAR ist eine Paketverwaltung, die normalerweise Teil einer PHP-Distribution ist. Leider war diese auf dem Server nicht funktionsf&#xE4;hig und eine Neuinstallation war nicht m&#xF6;glich, denn die PEAR-Homepage wurde vor wenigen Wochen gehackt, und es stellte sich heraus, dass das Zentrale PHP-Skript dieser Anwendung seit Monaten kontaminiert ist.<sup><a href="#quelleZuPear">1</a></sup><br>
Im weiteren Verlauf der Entwicklung, vor allem f&#xFC;r die Entwicklung, vor allem f&#xFC;r das Generieren der QR-Code-API kam eine weitere, wesentlich einfacher nutzbare PHP-Paketverwaltung ans Licht, der Composer. Der Composer wird einfach als Binary auf dem Server installiert und ist anschlie&#xDF;end &#xFC;ber den Konsolenbefehl <code>$ composer ...</code> aufrufbar. Composer &#xE4;hnelt sehr stark der npm-Paketverwaltung auf node.js und wird sehr &#xE4;hnlich zu dieser gehandhabt. &#xDC;ber den Befehl <code>$ composer require KOMPONENTENNAME</code> , der jedoch im selben Pfad wie die Datei aufgerufen wird, kann die entsprechende Komponente aus dem Composer-Repository gemeinsam mit zugeh&#xF6;rigen Abh&#xE4;ngigkeiten in den Dateipfad installiert werden. Zus&#xE4;tzlich wird eine Datei composer.json erstellt oder erweitert. Diese Datei ist sehr wichtig, da sie &#xFC;ber den Befehl <code>$ composer install</code> aufgerufen werden kann und automatisch alle Abh&#xE4;ngigkeiten installiert. Vor allem beim Transfer der Websites auf einen anderen Server ist dies hilfreich, da somit die Dependencies automatisch aus dem Internet abgerufen werden. Aus diesem Grund ist die Installation des Composers auch ein Kernbestandteil der Installation. Der Composer bietet es auch an, einzelne pecl-Komponenten als selbstinstallierende .phar-Dateien abzurufen, und diese dann selbst zu installieren. Zu diesen geh&#xF6;rte auch pecl_http Dieser Bezugsweg funktionierte jedoch am Ende auch nicht. Diese Skripte sind so implementiert, dass sie ihren eigenen Hash-Wert &#xFC;berpr&#xFC;fen und daher keine Ver&#xE4;nderungen zulassen. Beim Aufruf einer solchen .phar-Datei konnte somit das Problem, dass Zeilenenden nicht abrufbar waren, da das Carriage-Return-Zeichen nicht gesetzt wurde, nicht durch entsprechende &#xC4;nderung der Datei gel&#xF6;st werden. Aus diesem Grund musste endg&#xFC;ltig auf Enums und die http()-Funktion verzichtet werden, was zu gewissen Ver&#xE4;nderungen in den Skripten <code>appdaemon.php</code> und <code>certificate.php</code> f&#xFC;hrte. Der Composer funktionierte im Gegensatz dazu hervorragend und erm&#xF6;glichte die Einbindung des PHP-Mailers und des PHP-Qrcode-Tools.</p>
<h2 class="mume-header" id="4-a-namebenutzungvoncurlabenutzung-von-curl">4. <a name="BenutzungvoncURL" href=""></a>Benutzung von cURL</h2>

<p>cURL ist eine sehr umfangreiche Anwendung, die auf Unix-Systemen teilweise auch als Installer und Skriptsprache verwendet wird. Sie ist grunds&#xE4;tzlich erst einmal daf&#xFC;r zust&#xE4;ndig, um TCP/IP-Verbindungen aufzubauen, kann jedoch mit einer Logik und verschiedenen Parametern versehen werden und dadurch als kompletter Installer oder in diesem Use-Case f&#xFC;r HTTP-basierten Datenaustausch verwendet werden. PHP unterst&#xFC;tzt in der XAMPP-Installation cURL nativ. Dies wird bewerkstelligt, indem das <code>php.ini</code> auf die <code>curl.exe</code> (also die cURL-Anwendung) auf dem Apache-Server verweist. Somit l&#xE4;sst sich cURL einfach &#xFC;ber verschiedene Funktionen aufrufen. cURL war jedoch zun&#xE4;chst eine Blackbox, da es, wenn es falsch parametrisiert wird, keinen Fehler, sondern einfach nichts ausgibt. Nach l&#xE4;ngerem Suchen konnte der Verbose-Parameter aktiviert werden, der jedoch den Text in den Error-Stream schob, was beim Testen im Browser unhandlich war, weil dieser sich nicht l&#xF6;scht. Der Ausgabestream von cURL musste zum Testen in den Ausgabestream des Browsers geschoben werden. Da dieser Stream jedoch nicht in einen String geschrieben werden kann, musste er in einen File-Pointer in den RAM geschoben werden, der am Ende wieder in einen String geparst und durch echo an den Browser ausgegeben wird. Die Alternative, das cURL-Logging direkt auf den Ausgabestream zu verweisen funktionierte nicht, da beim direkten Transfer in den Ausgabestream kein Buffering betrieben wird, wie es bei der echo-Funktion der Fall ist. Folglich wurden die Strings ineinander vermischt und waren nicht lesbar.<br>
Mithilfe des Verbose-Parameters konnten die Richtigen cURL-Parameter gefunden werden. Dieser geschilderte Sachzusammenhang sowie die letztendlich gefundenen Parameter sind alle in der Datei <code>certificate.php</code> eingespeichert, wobei die Parameter f&#xFC;r das Verbose auskommentiert werden mussten, da sie sonst im Release die cURL-Logs auf der Website dargestellt werden w&#xFC;rden. Hierbei war sehr hilfreich, das cURL-Client-Zertifikat durch das CA-Root-Zertifikat auszutauschen, was dazu f&#xFC;hrte, dass zumindest das Client-Zertifikat nicht mehr ung&#xFC;ltig ist. F&#xFC;r den direkten Zugriff auf die IP-Adresse des Servers musste jedoch der Parameter gesetzt werden, dass die fehlende Servervalidierung ignoriert wird, trotz eines signierten Zertifikates, ansonsten gab cURL nie eine Antwort zur&#xFC;ck, weil es die Verbindung ablehnte. Dies zu ignorieren war bei PHP noch m&#xF6;glich, half jedoch nicht mehr im Fall von IOS-Apps, was das Thema Sicherheit noch einmal g&#xE4;nzlich zu seinem Anfang zur&#xFC;ckwarf.</p>
<h2 class="mume-header" id="5-a-namesicherheitundkonfigurationdesapache-serversasicherheit-und-konfiguration-des-apache-servers">5. <a name="SicherheitundKonfigurationdesApache-Servers" href=""></a>Sicherheit und Konfiguration des Apache-Servers</h2>

<p>In seiner Grundkonfiguration unterst&#xFC;tzt der Apache-Server lediglich http &#xFC;ber den Port 80 und verzichtet auf jegliche Form der Verschl&#xFC;sselung. Alleine diese Ports nach au&#xDF;en freizugeben, war bereits eine sehr gro&#xDF;e Herausforderung, wie in einem anderen Teil dieser Dokumentation erl&#xE4;utert wird. Auch die Umkonfigurierung der Konfigurationsoberfl&#xE4;che, damit sie auch &#xFC;ber den normalen WWW-Port 80 und nicht mehr &#xFC;ber den entsprechenden Port 8080 abrufbar ist, war sehr komplex. In diesem Teil geht es jedoch darum, die Konfiguration des Servers zu vollenden und einen sichere sowie authentifizierte Verbindung zu erm&#xF6;glichen. Zun&#xE4;chst war es also das Ziel, HTTPS freizuschalten und anschlie&#xDF;end den Client dazu zu zwingen, die Websites auch als HTTPS-Datei anzufordern. Denn bei der Eingabe eines Links ohne Protokollauswahl, also ohne <code>&quot;http://&quot;</code>, <code>&quot;https://&quot;</code> oder Sonstiges einzugeben, w&#xE4;hlt ein Browser und genauso auch eine cURL-, fetch()- oder sonstige API HTTP &#xFC;ber Port 80 als Protokoll aus und ruft trotz aktivem HTTPS-Protokoll auf dem Port 443 die Seite unverschl&#xFC;sselt ab und versendet Requests, die wom&#xF6;glich auch Passw&#xF6;rter beinhalten, zus&#xE4;tzlich auch v&#xF6;llig unverschl&#xFC;sselt. Die L&#xF6;sung ist hierbei eine Weiterleitungs-Antwort an den Client. Jegliche Anfrage des Clients an den Port 80 des Servers wird mit einem HTTP 3xx-Paket beantwortet, was immer bedeutet, dass der Server den Client weiterleitet. Um genau zu sein erh&#xE4;lt der Client die Meldung <code>&quot;HTTP/1.1 Moved Permanently&quot;</code>, was entsprechend des W3C auch Standard f&#xFC;r eine Weiterleitung nach HTTPS ist.<sup><a href="#HTTP_StatusCodes">2</a></sup><br>
Dies funktoniert auch bei Websites, die gar nicht existieren. Es wird nie auch nur ein Zugriff auf das Dateiverzeichnis zugelassen, ohne dass die Verschl&#xFC;sselung aktiviert wurde.<br>
<img src="./Ausschnitt_Firefox_Debugger.png" alt="Screenshot aus dem Firefox-Webdebugger"><br>
Dies wurde durch das Verwenden der Rewrite-Engine bewerkstelligt. Diese musste in der Konfigurationsdatei <code>%xampp%/apache/conf/httpd.conf</code> , also der Hauptkonfigurationsdatei des Apache-Servers aktiviert werden. Die entsprechende Konfiguration ist diese:</p>
<pre data-role="codeBlock" data-info="ApacheConf" class="language-apacheconf"><span class="token comment"># Anderer Code&#x2026; </span>
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>Directory</span><span class="token directive-block-parameter attr-value"> &quot;C<span class="token punctuation">:</span>/Projekt/xampp/htdocs&quot;</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment"># Anderer Code&#x2026;</span>
    <span class="token comment"># Diese Einstellungen sind n&#xF6;tig, um eine http 301 Weiterleitung f&#xFC;r alle Adressen nach https sicherzustellen</span>
    <span class="token directive-inline property">RewriteEngine</span> On
    <span class="token directive-inline property">RewriteCond</span> <span class="token variable">%{HTTPS}</span> !=on
    <span class="token directive-inline property">RewriteRule</span> <span class="token regex">^ https://</span><span class="token variable">%{HTTP_HOST}</span><span class="token variable">%{REQUEST_URI}</span> [L,R=301]
    <span class="token comment"># RewriteEngine aktivieren</span>
    <span class="token comment"># Bedingung f&#xFC;r den Rewrite: Request beginnt nicht mit HTTPS</span>
    <span class="token comment"># Definition der Regel:</span>
    <span class="token comment"># Regel gilt f&#xFC;r alle Anforderungen ^</span>
    <span class="token comment"># Regel ersetzt den Text http://REQUEST_URI durch https://REQUEST_URI</span>
    <span class="token comment"># Regel sendet den Link zur&#xFC;ck an den Client, HTTP-Statuscode 301</span>
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>
<span class="token comment"># Anderer Code&#x2026;</span>
</pre><p>Somit werden nun alle Anfragen sicher auf HTTPS umgeleitet. Als n&#xE4;chstes war die Einbindung von Zertifikaten von Relevanz, denn der Browser warnte beim Aufruf einer Seite, dass das Zertifikat unsicher und nicht vertraunsw&#xFC;rdig ist. Zun&#xE4;chst einmal musste das alte Zertifikat, also das zu der Serverinstallation geh&#xF6;rende selbst signierte Zertifikat ohnehin ersetzt werden, da es nur mit dem SHA1-Algorithmus verschl&#xFC;sselt wurde, nicht mit SHA2, einem neueren Hashing-Standard. Aus diesem Grund stand eine l&#xE4;ngere Auseinandersetzung mit dem Verschl&#xFC;sselungstool openssl an, was als Teil von Apache mitinstalliert wurde. Zun&#xE4;chst war hierzu die Erstellung eines Config-Files notwendig, da jeder Befehl in Openssl fehlschl&#xE4;gt, wenn keine Konfigurationsdatei existiert. Diese Konfigurationdatei entspricht auch nicht der Standarddatei, da sie so umgebaut wurde, dass der User beim Erstellen einer Zertifikatsanforderung (CSR, Certificate Signing Request) keine Fragen gestellt bekommt und Openssl somit &#xFC;ber Kommandzeilenbefehle aufgerufen werden kann.<br>
<img src="./Openssl_Configfile.png" alt="Configfile f&#xFC;r Openssl"><br>
Die Datei ist unter dem Namen certify_server.cnf abrufbar. Die entsprechende Steuerung sollte auch automatisiert werden. Hierzu wurde alles wurde in ein Powershell-Skript geb&#xFC;ndelt. Eine Fortsetzende Nummerierung der Zertifikate wurde auch geplant, war jedoch nicht erfolgreich. Dieses Zertifikat bietet nun die M&#xF6;glichkeit, durch Klick die gesamte Zertifikatkonfiguration und -signierung automatisch vorzunehmen, jedoch lediglich f&#xFC;r selbst signierte Zertifikate. Es wurd zuerst ein Zertifikat erstellt und selbst signiert, das die Rolle des Stammzertifikats einnimmt. Anschlie&#xDF;end werden 3 CSRs erstellt, die von diesem Zertifikat signiert und zu echten Zertifikaten umgewandelt werden. Dieses Skript funktioniert v&#xF6;llig autonom, jedoch darf weder dessen Pfad noch der Pfad der Config-Datei ver&#xE4;ndert werden. Ansonsten w&#xFC;rde auch der Server die Zertifikate nicht finden. Um dieses Skript effektiv nutzen zu k&#xF6;nnen, wurden die Pfade in der Server-Konfiguration angepasst. Dies ist in der Datei httpd-ssl.cnf durchgef&#xFC;hrt worden. Dar&#xFC;ber hinaus wurden dort auch die Sicherheitsstandards erh&#xF6;ht. Es wird f&#xFC;r die &#xDC;bertragung nur noch TLSv1.2 zugelassen, was das sicherste durch den Apache-Server unterst&#xFC;tzte Protokoll darstellt. Als sp&#xE4;ter die Implementierung der Daten&#xFC;bertragung mit der Mobile-App anstand, musste letztendlich doch auf selbst signierte Zertifikate verzichtet werden. Hierzu war eine Domain n&#xF6;tig, die anschlie&#xDF;end von Let&#x2019;s encrypt ein Zertifikat erhalten kann. Hierzu wurde zun&#xE4;chst eine Domain bei <a href="http://noip.com">noip.com</a> registriert, die den Namen <a href="http://fhwswebbankingapp.ddns.net">fhwswebbankingapp.ddns.net</a> erhielt, denn IP-Adressen ohne DNS-Record k&#xF6;nnen zumindest bei Let&#x2019;s encrypt keine signierten Zertifikate erhalten. Zus&#xE4;tzlich wurde &#xFC;ber den Composer ein php-Skript bezogen und konfiguriert, das automatisch Zertifikate von der entsprechenden Let&#x2019;s encrypt-API beziehen w&#xFC;rde. jedoch ben&#xF6;tigt dessen Aktivierung eine Rekonfiguration der virtuellen hosts, was jedoch die Zielsetzung &#xFC;berstieg und daher nicht mehr in Betracht kam. Folglich wurde als Alternative die manuelle Bereitstellung der signierten Zertifikate durchgef&#xFC;hrt, die anschlie&#xDF;end &#xFC;ber das Powershell-Skript weitere Zertifikate signieren w&#xFC;rde. Hierzu wurde zun&#xE4;chst &#xFC;ber die Website <a href="http://sslforfree.com">sslforfree.com</a> ein signiertes Zertifikat bezogen. Der Versuch war, das Skript umzubauen, sodass anstelle des selbst signierten Zertifikats das von <a href="http://sslforfree.com">sslforfree.com</a> erhaltene Zertifikat als Stammzertifikat verwendet wird und anschlie&#xDF;end die 3 weiteren Zertifikate signiert. Dies funktionierte zwar, war jedoch nicht hilfreich, da die Konfiguration so h&#xE4;tte angepasst werden m&#xFC;ssen, dass die Zertifikate als Baum in ein Zertifikat gepackt werden. Auch dies &#xFC;berstieg jedoch die Zielsetzung des Projekts und es blieb am Ende bei zwei Alternativen: Entweder werden die Zertifikate automatisch &#xFC;ber ein Skript bereitgestellt, das in regelm&#xE4;&#xDF;igen Zeitabst&#xE4;nden durch die Windows-Augabenplanung aufgerufen wird, oder man bezieht alle 90 Tage &#xFC;ber den Webdienst <a href="http://sslforfree.com">sslforfree.com</a> ein offiziell signiertes Zertifikat und ordnet es dem korrekten Pfad zu. Diese Pfade mussten alle genau in httpd-ssl.cnf genau definiert werden. Weitere Ver&#xE4;nderungen befinden sich mit entsprechenden Dokumentationen in dieser Datei. Das PowerShell1-Skript, das f&#xFC;r die Automatisierung notwendig ist, befindet sich im Anhang dieses Dokuments. Bei der Wahl des selbst signierten Zertifikates ist die Kommunikation mit IOS jedoch nicht mehr garantiert aktuell muss die info.plist-Datei ge&#xE4;ndert werden, um die Sicherheitsausnahme zu genehmigen. Das exakte Verfahren zur Genehmigung der Sicherheitsausnahme auf einem Mobilger&#xE4;t ist jedoch nicht best&#xE4;ndig und wird von Apple h&#xE4;ufig ver&#xE4;ndert.</p>
<pre data-role="codeBlock" data-info="PowerShell" class="language-powershell"><span class="token comment">#Root-Zertifikat ausstellen und direkt signieren</span>
openssl req <span class="token operator">-</span>x509 <span class="token operator">-</span>newkey rsa:4096 <span class="token operator">-</span>keyout <span class="token string">&quot;./ssl.key/ca-bundle.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.crt/ca-bundle.crt&quot;</span> <span class="token operator">-</span>days 3650 <span class="token operator">-</span>config certify_server<span class="token punctuation">.</span>cnf <span class="token operator">-</span>sha512 <span class="token operator">-</span>nodes
openssl rsa <span class="token operator">-in</span> <span class="token string">&quot;./ssl.key/ca-bundle.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.key/ca-public.key&quot;</span>
<span class="token string">&quot;&quot;</span> &gt;<span class="token string">&quot;./ssl.crt/serial.srl&quot;</span>
<span class="token variable">$str</span>  = openssl x509 <span class="token operator">-in</span> <span class="token string">&quot;./ssl.crt/ca-bundle.crt&quot;</span> <span class="token operator">-</span>noout <span class="token operator">-</span>serial
<span class="token variable">$str</span> = <span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Substring<span class="token punctuation">(</span> 7 <span class="token punctuation">,</span> 16 <span class="token punctuation">)</span>
<span class="token variable">$str</span> &gt; <span class="token string">&quot;./ssl.crt/serial.srl&quot;</span> <span class="token comment">#Serialnummer in die Datei einf&#xFC;gen. Die Deklaration muss vorher aus dem String entfernt werden.</span>
openssl req <span class="token operator">-</span>x509 <span class="token operator">-</span>newkey rsa:4096 <span class="token operator">-</span>keyout <span class="token string">&quot;./server-ca.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./server-ca.crt&quot;</span> <span class="token operator">-</span>days 3650 <span class="token operator">-</span>config certify_server<span class="token punctuation">.</span>cnf <span class="token operator">-</span>sha512 <span class="token operator">-</span>nodes
<span class="token comment">#Certificate Signing Request aus drei zuf&#xE4;lligen Schl&#xFC;sseln generieren</span>
openssl req <span class="token operator">-</span>new <span class="token operator">-</span>newkey rsa:4096 <span class="token operator">-</span>keyout <span class="token string">&quot;./ssl.key/server0.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.csr/cert0.csr&quot;</span> <span class="token operator">-</span>days 3650 <span class="token operator">-</span>config certify_server<span class="token punctuation">.</span>cnf <span class="token operator">-</span>sha512 <span class="token operator">-</span>nodes
openssl req <span class="token operator">-</span>new <span class="token operator">-</span>newkey rsa:4096 <span class="token operator">-</span>keyout <span class="token string">&quot;./ssl.key/server1.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.csr/cert1.csr&quot;</span> <span class="token operator">-</span>days 3650 <span class="token operator">-</span>config certify_server<span class="token punctuation">.</span>cnf <span class="token operator">-</span>sha512 <span class="token operator">-</span>nodes
openssl req <span class="token operator">-</span>new <span class="token operator">-</span>newkey rsa:4096 <span class="token operator">-</span>keyout <span class="token string">&quot;./ssl.key/server2.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.csr/cert2.csr&quot;</span> <span class="token operator">-</span>days 3650 <span class="token operator">-</span>config certify_server<span class="token punctuation">.</span>cnf <span class="token operator">-</span>sha512 <span class="token operator">-</span>nodes
<span class="token comment">#Public Keys generieren</span>
openssl rsa <span class="token operator">-in</span> <span class="token string">&quot;./ssl.key/server0.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.key/pub0.key&quot;</span>
openssl rsa <span class="token operator">-in</span> <span class="token string">&quot;./ssl.key/server1.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.key/pub1.key&quot;</span>
openssl rsa <span class="token operator">-in</span> <span class="token string">&quot;./ssl.key/server2.key&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.key/pub2.key&quot;</span>
<span class="token comment">#Zertifikate mit dem Root-Zertifikat ausstellen</span>
openssl x509 <span class="token operator">-</span>req <span class="token operator">-</span>CA <span class="token string">&quot;./ssl.crt/ca-bundle.crt&quot;</span> <span class="token operator">-</span>CAkey <span class="token string">&quot;./ssl.key/ca-bundle.key&quot;</span> <span class="token operator">-in</span> <span class="token string">&quot;./ssl.csr/cert0.csr&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.crt/cert0.crt&quot;</span> <span class="token operator">-</span>days 3650 <span class="token operator">-</span>CAcreateserial <span class="token comment">#-CAserial &quot;./ssl.crt/serial.srl&quot;</span>
openssl x509 <span class="token operator">-</span>req <span class="token operator">-</span>CA <span class="token string">&quot;./ssl.crt/ca-bundle.crt&quot;</span> <span class="token operator">-</span>CAkey <span class="token string">&quot;./ssl.key/ca-bundle.key&quot;</span> <span class="token operator">-in</span> <span class="token string">&quot;./ssl.csr/cert1.csr&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.crt/cert1.crt&quot;</span> <span class="token operator">-</span>days 3650 <span class="token operator">-</span>CAcreateserial <span class="token comment">#-CAserial &quot;./ssl.crt/serial.srl&quot;</span>
openssl x509 <span class="token operator">-</span>req <span class="token operator">-</span>CA <span class="token string">&quot;./ssl.crt/ca-bundle.crt&quot;</span> <span class="token operator">-</span>CAkey <span class="token string">&quot;./ssl.key/ca-bundle.key&quot;</span> <span class="token operator">-in</span> <span class="token string">&quot;./ssl.csr/cert2.csr&quot;</span> <span class="token operator">-</span>out <span class="token string">&quot;./ssl.crt/cert2.crt&quot;</span> <span class="token operator">-</span>days 3650 <span class="token operator">-</span>CAcreateserial <span class="token comment">#-CAserial &quot;./ssl.crt/serial.srl&quot;</span>
<span class="token comment">#Zertifikate mit dem Let&apos;s Encrypt - Zertifikat signieren</span>
<span class="token comment">#openssl x509 -req -CA &quot;./ssl.crt/sslforfree.crt&quot; -CAkey &quot;./ssl.key/sslforfree.key&quot; -in &quot;./ssl.csr/cert0.csr&quot; -out &quot;./ssl.crt/cert0.crt&quot; -CAcreateserial</span>
<span class="token comment">#openssl x509 -req -CA &quot;./ssl.crt/sslforfree.crt&quot; -CAkey &quot;./ssl.key/sslforfree.key&quot; -in &quot;./ssl.csr/cert1.csr&quot; -out &quot;./ssl.crt/cert1.crt&quot; -CAcreateserial</span>
<span class="token comment">#openssl x509 -req -CA &quot;./ssl.crt/sslforfree.crt&quot; -CAkey &quot;./ssl.key/sslforfree.key&quot; -in &quot;./ssl.csr/cert2.csr&quot; -out &quot;./ssl.crt/cert2.crt&quot; -CAcreateserial</span>
</pre><h2 class="mume-header" id="6-a-nameentwicklungenaufdemserveraentwicklungen-auf-dem-server">6. <a name="EntwicklungenaufdemServer" href=""></a>Entwicklungen auf dem Server</h2>

<p>Beim Backend war das Ziel, mehrere Komponenten im User Management aufzubauen. Prim&#xE4;r waren dies Login, Registrierung und Aktivierung eines User-Accounts. Dies bedeutet, dass diese Komponenten alle au&#xDF;erhalb der gesch&#xE4;ftlichen Abwicklungen und des produktiven Online-Bankings liegen.<br>
Die Zielsetzung war f&#xFC;r den Login, eine Seite bereitzustellen, bei der ein User seinen Namen und sein Passwort eingibt. Diese &#xFC;berpr&#xFC;ft, ob die Eingaben vorhanden sind und f&#xFC;hrt anschlie&#xDF;end einen Anmeldeversuch durch. Sind Name und Passwort eine korrekte Kombination, wird der Login ausgef&#xFC;hrt. Hierbei wird dementsprechend die Homepage aufgerufen.<br>
Die n&#xE4;chste Komponente war die Registrierung eines Accounts. Hierbei soll ein User seine pers&#xF6;nlichen Daten in ein Formular eingeben, die anschlie&#xDF;end in die Datenbank eingetragen werden. Ist dieser Vorgang erfolgreich, wird dem User eine Meldung ausgegeben, die seine erfolgreich eingespeicherten Informationen anzeigt.<br>
Als dritte Komponente ist der Passwort-Vergessen-Modus zu sehen. Der User gibt seine E-Mail-Adresse an und erh&#xE4;lt anschlie&#xDF;end einen Link zugesendet, mit dem er sein Passwort neu setzen kann. Hierf&#xFC;r muss die M&#xF6;glichkeit eines Mailing-Dienstes eingerichtet werden.<br>
Die vierte und letzte Komponente mit nennenswerten Web-Frontend-Aktivit&#xE4;ten ist die Generierung eines Shared Secrets. Hierbei ist das Ziel, dass der User mit seiner App einen QR-Code einscannen kann, der ihm auf dem Web-Frontend angezeigt wird. Dies erm&#xF6;glicht einen indirekten Austausch von Informationen und senkt das Risiko eines Botangriffs, da die Verwendung einer Kamera f&#xFC;r die Funktionalit&#xE4;t vorausgesetzt wird. F&#xFC;r das Erreichen dieses Ziels ist die Einrichtung einer QR-Code-API zwingend notwendig.<br>
Als weiteres Ziel gilt die User-Aktivierung. Wird ein User neu eingerichtet, so muss er innerhalb von 48 Stunden seine Email-Adresse best&#xE4;tigen, um zu verhindern, dass sein Account wieder gel&#xF6;scht wird.<br>
Hierbei entstanden auch mehrere Zielsetzungen im Bereich der Datenbank. F&#xFC;r das Aktivieren eines Accounts sowie das Generieren von Passwort-Vergessen-Links ist es notwendig, dass sich neu angelegte Eintr&#xE4;ge selbstt&#xE4;tig l&#xF6;schen. Hierzu musste die n&#xF6;tige Anpassung an der Datenbank vorgenommen werden. Zus&#xE4;tzlich sollten mehrere Datenbankspalten auf ein erh&#xF6;htes Sicherheitsniveau gebracht werden. Aus diesem Grund war es das Ziel, m&#xF6;glichst viele Werte nur noch als deren Hashwert auf der Datenbank zu hinterlegen, um Daten auf dem Backend nicht vollst&#xE4;ndig frei abrufbar zu gestalten.<br>
Zun&#xE4;chst gab es als weiteres Ziel, eine Schnittstelle f&#xFC;r die App bereitzustellen. Hierzu wird prim&#xE4;r ein Empf&#xE4;nger f&#xFC;r verschiedene HTTP-Pakete ben&#xF6;tigt, der auch in Form einer API realisiert werden kann, und zus&#xE4;tzlich ein Dienst, der Push-Benachrichtigungen ausf&#xFC;hrt.</p>
<h3 class="mume-header" id="61-a-nameloginalogin">6.1. <a name="Login" href=""></a>Login</h3>

<p>Alle Skripte des Servers wurden in PHP realisiert. Hierzu z&#xE4;hlt der Login, der im Skript <code>login.php</code> implementiert wurde. Das Frontend basiert auf HTML 5, wobei nach verschiedenen Versuchen das CI-Template sb-admin verwendet wurde. Somit war das CSS bereits erst einmal in gr&#xF6;&#xDF;ten Z&#xFC;gen vorbereitet. N&#xF6;tig war hierbei auch die Einbindung von Bootstrap, dass mehrere Designfragen wesentlich vereinfacht. Zus&#xE4;tzlich wurden JQuery und AJAX eingebunden, was bei diesem Skript Daten&#xFC;bertragungen und DOM-Handling vereinfachte. Das Skript beginnt bei einem GET-Aufruf zun&#xE4;chst im PHP-Teil und zerst&#xF6;rt eine gegebenenfalls aktive Session. Anschlie&#xDF;end wird das HTML mit einer Eingabemaske aufgerufen. Der geforderte Benutzername ist hierbei die einmalige Kundennummer des Kunden, die er bei seiner Account-Registrierung erh&#xE4;lt.<br>
Das HTML l&#xE4;dt zus&#xE4;tzlich die Captcha-API mit, die verhindert, dass ein Bot unbegrenzt Angriffe auf diese Seite ausf&#xFC;hrt. Das Captcha wird aktiv, sobald der User auf den Login-Button dr&#xFC;ckt, der seine Credentials an den Server &#xFC;bermitteln soll. Dies l&#xF6;st bei dieser Site keinen direkten Submit aus, sondern die JavaScript-Funktion <code>prepareSubmit()</code>. Dort wird zun&#xE4;chst durch das Captcha-Skript ein Captcha-Key generiert, der an die Google-Captcha-API versendet wird. Im Falle eines weniger vertrauensw&#xFC;rdigen Users wird hierbei jedoch erst eine Aufgabe an den User gerendert. Die Antwort von Google wird anschlie&#xDF;end an den Server gesendet, der das Captcha und die Vertrauensw&#xFC;rdigkeit des Users noch einmal mit seinem Private-Key bei der Google-API signieren l&#xE4;sst. Die hierzu eingerichtete Datei tr&#xE4;gt den Namen <code>captcha.php</code>. Dort ist auch das exakte Vorgehen erkl&#xE4;rt, das den User als menschlichen User verifiziert. Der Useability-Vorteil ist hierbei, dass die Captcha-Version 3 mit einem Scoring-Profil seiner User arbeitet und somit nicht immer eine Aufgabe (Challenge) f&#xFC;r den Client generiert, wenn dessen Vertrauensw&#xFC;rdigkeit hoch ist. Bei all diesen Vorg&#xE4;ngen wird ein HTTP-POST zur Daten&#xFC;bertragung verwendet, um sicherzustellen, dass die signifikanten Daten sicher im Body der Nachricht &#xFC;bermittelt werden und nicht bereits &#xFC;ber die URL abrufbar sind.<br>
Ist der User signiert, wird anschlie&#xDF;end der Rest der JavaScript-Funktion ausgef&#xFC;hrt. Durch JQuery werden Username und Passwort als POST an das Skript selbst &#xFC;bermittelt.<br>
In diesem Fall befindet sich das Skript im POST-Modus. Es &#xFC;berpr&#xFC;ft in der Datenbank-Tabelle &#x201A;kunde&#x2018;, ob Username und Passwort vorhanden sind, generiert eine Session und leitet den Client bei Erfolg anschlie&#xDF;end direkt &#xFC;ber die header()-Funktion in PHP an die n&#xE4;chste Site, <code>index.php</code> weiter. Bei Misserfolg wird das Formular in derselben Form noch einmal ge&#xF6;ffnet, jedoch mit einem Hinweis, dass der Login nicht erfolgreich war.</p>
<h3 class="mume-header" id="62-a-nameregistrierungaregistrierung">6.2. <a name="Registrierung" href=""></a>Registrierung</h3>

<p>Bei der Registrierung wird zun&#xE4;chst ein sehr &#xE4;hnliches Formular wie beim Login verwendet. Hierbei gibt es jedoch wesentlich mehr Input-Fenster, von denen drei auch einer zus&#xE4;tzlichen &#xDC;berpr&#xFC;fung ben&#xF6;tigen. Hierbei wird mithilfe von JavaScript sichergestellt, dass der Register-Button nur aktiv ist, wenn alle Input-Fenster einen Inhalt haben und die Passwortfenster beide mit exakt demselben Inhalt versehen sind. Die Verifikation der Echtheit der Email-Adresse wird durch den Browser &#xFC;bernommen.<br>
Das Formular wird beim Dr&#xFC;cken auf den Registerknopf anschlie&#xDF;end analog zum Login versendet, wobei die Eingaben hierbei in BASE64 kodiert werden, um sicherzustellen, dass keine Encodingfehler bei den in Unicode eingegebenen Stammdaten des Users auftreten. Wieder findet eine Captcha-Verifizierung statt, an deren Ende ein POST mit allen eingegebenen Daten ausgef&#xFC;hrt wird, das Ziel ist die Seite selbst.<br>
Beim Erhalt der Daten im POST wird eine umfassende &#xDC;berpr&#xFC;fung der Daten vorgenommen. Zun&#xE4;chst wird die E-Mail-Adresse daraufhin &#xFC;berpr&#xFC;ft, ob nicht bereits ein anderer Kunde diese E-Mail-Adresse verwendet. Ist diese noch nicht in Verwendung, wird der User angelegt, wobei das Passwort als SHA512-Wert gespeichert wird. Anschlie&#xDF;end wird die Datenbank dahingehend &#xFC;berpr&#xFC;ft, dass der Eintrag erfolgreich angelegt wurde. Zus&#xE4;tzlich wird an die eingegebene Mail ein Aktivierungslink versendet. Die entstandene ID wird auch aus der Datenbank abgerufen.<br>
Die Daten werden nun in die Website geladen. Hierzu wird mithilfe von PHP die gesamte Site umgebaut. Anstatt einer Card zeigt die Seit nun ein Modal, also ein Dialogfenster an. Das Modal zeigt entweder, dass die E-Mail-Adresse bereits verwendet wurde und er eine andere Email versuchen soll, oder gibt die Stammdaten des Users aus. Er erh&#xE4;lt nun die Meldung, dass sein Account aktiviert sei und dass dieser gewisse Stammdaten beinhalte, die eine Tabelle zeigt. Ein zus&#xE4;tzlich erzeugter Button leitet den User auf die Homepage weiter.<br>
Der f&#xFC;r die &#xDC;berpr&#xFC;fung der Eingaben sowie die Ver&#xE4;nderung des Front-Ends n&#xF6;tige umfassende JavaScript-Code ist im Quellcode genauer beschrieben. Das Versenden der Email an die angegebene E-Mail-Adresse wird &#xFC;ber das Skript <code>mailAgent.php</code> ausgef&#xFC;hrt. Dort wird ein HTML-Template mit den Daten des Users best&#xFC;ckt und anschlie&#xDF;end mit dem sogenannten PHPMailer versendet. Das Ablaufdatum des Users ist in der Tabelle &#x201A;kunde&#x2018; mithinterlegt und wird bei erfolgreichem Best&#xE4;tigen der Email auf 0 gesetzt, was dazu f&#xFC;hrt, dass der Account nicht gel&#xF6;scht wird.</p>
<h3 class="mume-header" id="63-a-namegenerierungdessharedsecretsagenerierung-des-shared-secrets">6.3. <a name="GenerierungdesSharedSecrets" href=""></a>Generierung des Shared Secrets</h3>

<p>F&#xFC;r die Kommunikation mit dem MobileAgent, einer Applikation ist eine Zweifaktorauthentifizierung vorgesehen. Dazu geh&#xF6;rt ein QR-Code, den das Mobilger&#xE4;t einscannt und damit das Shared Secret in seinem Speicher hinterlegt. Dieser Vorgang wird mit der Website <code>certificate.php</code> ausgel&#xF6;st. Dieses Skript hat folgende Funktionsweise:<br>
Zun&#xE4;chst erh&#xE4;lt das Skript die Session des angemeldeten Users, aus der es anschlie&#xDF;end eine User-ID abfragt. Die abgefragte ID wird nun dahingehend &#xFC;berpr&#xFC;ft, ob der Kunde in der Tabelle &#x201A;kunde&#x2018; vorhanden ist und ob f&#xFC;r den Kunden eine Session in der Tabelle &#x201A;appsession&#x2018; angelegt wurde. Ist beides der Fall, wird ein zuf&#xE4;lliger String erzeugt und dessen SHA512-Wert als Eintrag SECOND_SECRET eingespeichert.<br>
Dieser String soll nun auf das Handy &#xFC;bertragen werden. Hierzu wird eine selbst entworfene QR-Code-API verwendet, die sich im Skript <code>qrcode.php</code> befindet. Diese API basiert auf einer QR-Code-Bibliothek f&#xFC;r PHP aus GitHub. Mit deren Hilfe generiert die API aus dem String einen QR-Code und gibt ihn als BASE64-kodiertes Bild aus. Dieser BASE64-String wird anschlie&#xDF;end als Bild in die Website eingebunden, wobei die Gr&#xF6;&#xDF;e automatisch an die Bildschirmgr&#xF6;&#xDF;e angepasst wird. Der User hat nun die M&#xF6;glichkeit diesen QR-Code mit seinem Handy einzuscannen. Dieses Second Secret ist f&#xFC;r die Signierung eines Zahlungsvorgangs vorgesehen, die jedoch aufgrund von Fehlfunktionen und mangelhafter Dokumentation im eigesetzten &#x201A;Expo&#x2018;-Framework nicht zustande kommen konnte. Ein Button erm&#xF6;glicht es, mithilfe eines Website-Reloads den Code zu &#xE4;ndern, ein weiterer Button erm&#xF6;glicht es dem User, wieder zur Startseite zur&#xFC;ckzukehren.</p>
<h3 class="mume-header" id="64-a-namepasswort-vergessen-modusapasswort-vergessen-modus">6.4. <a name="Passwort-Vergessen-Modus" href=""></a>Passwort-Vergessen-Modus</h3>

<p>Der Passwort-Vergessen-Modus beruht auf zwei verschiedenen PHP-Dateien. Die erste Datei ist ein Eingabeformular f&#xFC;r eine E-Mail-Adresse, bei der ein User seine Adresse eingeben muss, an die anschlie&#xDF;end ein Recovery-Ticket gesendet wird. Das Recovery-Ticket ist 48 Stunden lang g&#xFC;ltig. Wird die E-Mail-Adresse noch einmal eingegeben, wird ein neues Recovery-Ticket generiert. Das Absenden wird mithilfe eines HTTP-POST durchgef&#xFC;hrt.<br>
Erh&#xE4;lt dieses Skript im POST eine E-Mail-Adresse, wird deren Existenz in der Datenbank-Tabelle &#x201A;kunde&#x2018; &#xFC;berpr&#xFC;ft. Anschlie&#xDF;end wird ein Token generiert. Dieses Token wird in einen Link gepackt, der mithilfe des Skripts <code>mailAgent.php</code> an die eingegebene Mailadresse versendet wird. Der SHA512-Wert des Tokens wird anschlie&#xDF;end mit Ablaufdatum in der Tabelle &#x201A;recovery&#x2018; eingespeichert, mithilfe eines REPLACE INTO- Befehls im SQL-Code wird damit sichergestellt, dass potentiell existierende alte Tickets &#xFC;berschreiben werden. Dabei wird vermieden, dass mehr als ein einziger g&#xFC;ltiger Recovery-Link existiert.<br>
Der Recovery-Link ruft die Website <code>recover-password.php</code> auf und &#xFC;bergibt im GET das Recovery-Token. Nachdem dieses Token verifiziert wurde, kann der User ein neues Passwort setzen. Dies erfolgt &#xFC;ber den POST-Modus, sodass es m&#xF6;glich wird, dass die Website mit mehreren verschiedenen Modi abgerufen werden kann. Es kann bei Fehlerhaften GET- oder POST-Daten ein Modal mit einer Fehlernachricht anzeigen und weist somit auch auf abgelaufene Recovery-Links hin.<br>
Die M&#xF6;glichkeit, das Passwort bei bereits eingeloggten Usern zur&#xFC;ckzusetzen wurde nicht implementiert. Hierzu wurde das Skript <code>reset-password.php</code> eingerichtet. Hiermit w&#xE4;re direkt mithilfe des Session-Keys eine Passwort&#xE4;nderung f&#xFC;r den eingeloggten User m&#xF6;glich.</p>
<h3 class="mume-header" id="65-a-nameanpassungenanderdatenbankaanpassungen-an-der-datenbank">6.5. <a name="AnpassungenanderDatenbank" href=""></a>Anpassungen an der Datenbank</h3>

<p>Es wurden f&#xFC;r die Implementierung der Ticketingsysteme bei der Accountaktivierung und des Passwort-Vergessen Modus zwei neue Tabellen generiert. Eine weitere Tabelle wurde f&#xFC;r die Implementierung eines Session-Systems der App implementiert. Alle Tabellen sind durch eine 1:1-Relation mit der Tabelle &#x201A;kunde&#x2018; verkn&#xFC;pft und nutzen dessen ID als Fremdschl&#xFC;ssel f&#xFC;r die Zuordnung ihrer Daten. Die Tabellen &#x201A;accountactivation&#x2018; f&#xFC;r neue Accounts und &#x201A;recovery&#x2018; f&#xFC;r vergessene Passw&#xF6;rter besitzen jeweils einen Datumswert, der das Ablaufdatum ihrer eingespeicherten Datens&#xE4;tze beschreibt. Hierzu wurden au&#xDF;erdem mehrere Aufgaben f&#xFC;r die Datenbank generiert. Diese l&#xF6;schen t&#xE4;glich die abgelaufenen Token sowie die neu eingerichteten, abgelaufenen User-Accounts, f&#xFC;r die keine Email-Best&#xE4;tigung vorliegt.  Letztere Aufgabe der Datenbank wird erst bei dem Produktivbetrieb aktiviert werden, da hierf&#xFC;r zun&#xE4;chst die gesamten Konten gel&#xF6;scht werden sollten.</p>
<h3 class="mume-header" id="66-a-namekommunikationmitderappakommunikation-mit-der-app">6.6. <a name="KommunikationmitderApp" href=""></a>Kommunikation mit der App</h3>

<p>F&#xFC;r die Kommunikation mit der App wurden drei Skripte bereitgestellt. Das erste Skript war eine versuchsweise Verwendung einer REST-API, zu finden unter <code>api.php</code> . Diese reichte jedoch nicht f&#xFC;r die umfangreichen Authentifizierungsvorg&#xE4;nge aus und wurde durch ein selbst entwickeltes Skript ersetzt. Das Skript mit dem Namen <code>appdaemon.php</code> ist der zentrale Kommunikationspartner der App und beantwortet alle zugetragenen Anforderungen. Die Anfragen der App werden in der Form x-www-urlencoded im Body &#xFC;bertragen. Die Antworten sind im JSON-Format. Die genaue Syntax und Funktionsweise der Anfragen ist im Skript selbst definiert. Um Push-Nachrichten zu erm&#xF6;glichen, wird dieses Skript durch die Datei <code>pushservice.php</code> unterst&#xFC;tzt. Diese f&#xFC;hrt Anmeldungen bei der Expo-Push-Cloud durch und sendet auch dorthin Push-Anfragen weiter. Genau hier entstand auch das sp&#xE4;tere Problem, dass die App nicht auf das Expo-Framework verzichten kann. Eine totale Umstellung aller Push-Dienste auf die Apple-Push-Services und die Android-Firebase-Dienste w&#xE4;re zwar m&#xF6;glich, entsprach jedoch nicht der Zielsetzung. Zus&#xE4;tzlich w&#xE4;re dies im Falle von IOS nur mit einer zu kaufenden Entwicklerlizenz m&#xF6;glich, die jedoch nicht vorlag. Weitere Informationen finden sich in der Dokumentation zur Datei Communication.js.</p>
<h2 class="mume-header" id="7-a-nameentwicklungdesmobileagentaentwicklung-des-mobile-agent">7. <a name="EntwicklungdesMobileAgent" href=""></a>Entwicklung des Mobile Agent</h2>

<p>Der Mobile Agent ist ein gro&#xDF;es eigenst&#xE4;ndiges Teilprojekt zu dem Onlinebanking Tool. Ziel war es eine mobile Anwendung f&#xFC;r unterschiedliche Endger&#xE4;te bereitzustellen. Dies sollten prim&#xE4;r IOS- und Android-Handys sein. Eine potentielle weitere Plattform waren sogenannte UWP-Apps, also Apps f&#xFC;r Windows-10-Endger&#xE4;te. Der Mobile Agent sollte die M&#xF6;glichkeit bieten, dass sich ein Kunde mit Username beziehungsweise Kundennummer und Passwort auf dem Handy anmeldet und anschlie&#xDF;end &#xFC;ber diesen Weg seine Buchungen verfolgen kann. Der Erste Ansatz, dies zu realisieren, erfolgte dementsprechend mit einem Multiplattform-Framework, das jedes dieser drei Endger&#xE4;te unterst&#xFC;tzt. Die Empfehlung des betreuenden Professors war Apache Cordova, mit dem auch zun&#xE4;chst ein erster Versuch implementiert wurde.</p>
<h3 class="mume-header" id="71-a-namewahldesframeworksawahl-des-frameworks">7.1. <a name="WahldesFrameworks" href=""></a>Wahl des Frameworks</h3>

<p>Apache Cordova ist ein Framework, dass alle aufgef&#xFC;hrten Ger&#xE4;te umfasst und sogar reine Webanwendungen erzeugen kann. Aus diesem Grund war hiermit bereits sichergestellt, dass alle Komponenten unterst&#xFC;tzt werden. Das Design der Apps erfolgt sehr stark angelehnt an normale Websites mit einem DOM-Handler und JavaScript-Code, der darauf zugreifen kann und weitere Steuerung der App &#xFC;bernimmt. Grunds&#xE4;tzlich funktioniert die Entwicklung so, dass zun&#xE4;chst die Funktionalit&#xE4;t der App in JavaScript geschrieben wird und anschlie&#xDF;end durch den Cordova-eigenen Compiler zu ger&#xE4;tespezifischen Source-Code umgewandelt wird. Dieser wird daraufhin vom Compiler der jeweiligen Plattform zu einer vollst&#xE4;ndigen Applikation kompiliert. Durch diese zwei Schritte ist es m&#xF6;glich, in der spezifischen Entwicklungsumgebung (also in Android Studio oder Xcode) auch plattformspezifischen Code einzuf&#xFC;gen, den Cordova nicht bereitstellen konnte. Durch die N&#xE4;he zu normalen Webanwendungen wurde bei Cordova anschlie&#xDF;end ein erster Versuch gestartet, eine funktionsf&#xE4;hige App bereitzustellen. Da die Frontendentwicklung etwas langwierig war, wurde ein neuer Versuch durchgef&#xFC;hrt, diesmal mit einem Frontendcode, der auf dem JavaScript-Framework Vue.js basiert. Hiermit wurde versucht, eine m&#xF6;glichst einfache und schnelle Entwicklung zu generieren, die aufgrund der starken N&#xE4;he zu normalem HTTP/CSS auf Websites gegeben zu sein schien.<br>
Nach weiteren Recherchen stellte sich jedoch heraus, dass die Zielsetzung mit React Native wesentlich einfacher zu bewerkstelligen ist, wobei jedoch die optionale Unterst&#xFC;tzung f&#xFC;r UWP-Apps endg&#xFC;ltig wegf&#xE4;llt. Dieses basiert auf React, einem JavaScript-Framework, das f&#xFC;r verschiedene Webanwendungen verwendet werden kann, jedoch mit einem eigenem Compiler, dem Babel-Compiler arbeitet. Deshalb existiert dort kein DOM, sondern eine sich dauerhaft wiederholende render()-Funktion, mit der das HTML abgerufen wird. Aus diesem Grund, und weil das HTML bei React v&#xF6;llig umgebaut werden muss, sind dort Entwicklungen aus Cordova nicht mehr nutzbar gewesen. Funktionalit&#xE4;ten mussten au&#xDF;erdem h&#xE4;ufig ver&#xE4;ndert werden, da lokale Variablen nicht w&#xE4;hrend der Laufzeit deklariert werden k&#xF6;nnen.<br>
Der Grund f&#xFC;r diesen gro&#xDF;en Schritt war die M&#xF6;glichkeit, eine Runtime-Umgebung einzusetzen, die &apos;Expo&apos;-App . Mit Expo konnte im Gegensatz zu Cordova einfaches und schnelles Debugging durchgef&#xFC;hrt werden, da der JavaScript-Code nahezu in Echtzeit auf einem Handy aktualisiert werden kann. Hierzu muss die Expo-App auf das Mobilger&#xE4;t installiert werden. Anschlie&#xDF;end wird der Sourcecode mithilfe des sogenannten Metro-Bundlers selbstst&#xE4;ndig, ausgel&#xF6;st durch eine Dateiver&#xE4;nderung, auf dem Computer kompiliert und &#xFC;ber HTTPS auf das Handy geladen. Die Apps sind folglich auch nicht als eigenes Bild auf dem Homescreen des Users zu sehen, sondern befinden sich innerhalb der &apos;Expo&apos;-Container-App, von der man sich nur trennen kann, wenn man die Apps &#xFC;ber Expo in einem Store ver&#xF6;ffentlicht oder zumindestens auf einem Staging-Portal wie Testflight bei IOS zur Verf&#xFC;gung stellt. Alternativ kann auch ein sogenannter eject ausgef&#xFC;hrt werden. Dort werden durch den sogenannten &apos;ExpoKit&apos; lokale Wrapper-Projekte f&#xFC;r IOS und Android erstellt, die es anschlie&#xDF;end erm&#xF6;glichen, den Code des Metro-Bundlers selbstst&#xE4;ndig als ger&#xE4;tespezifische App zu kompilieren.<br>
Die entstandene App besteht aus mehreren Komponenten: Einem Entry-Skript, einem Login-Skript, einem Stylesheet, jeweils einer Homepage f&#xFC;r angemeldete und neue User, sowie jeweils einem Skript f&#xFC;r die Steuerung des Speichers und des Datenaustausches. Eine besondere Rolle spielt ein weiteres Skript, das f&#xFC;r das Einscannen von QR-Codes zust&#xE4;ndig ist und deshalb eine Kamera nutzt.<br>
Dort kam nun auch die Frage auf, ob Expo, ExpoKit oder nur React Native verwendet werden soll. Das besondere an Expo ist n&#xE4;mlich, dass es das React-Native-Framework mit einigen Komponenten erg&#xE4;nzt, und dabei ger&#xE4;tespezfische Eigenheiten im Rahmen der Kompilierung automatisch erzeugt. Hierzu z&#xE4;hlen einfacherer Speicherzugriff und die Handhabung der Kamera. Mit reinem React Native sind diese Komponenten nicht realisierbar. Hierf&#xFC;r m&#xFC;sste plattformabh&#xE4;ngiger Code geschrieben werden. Diese Mischung aus Plattformabh&#xE4;ngigem Code und React-Native-Komponenten wiederum ist sehr buganf&#xE4;llig und erzeugte sehr verwirrende Fehler, wie beispielswiese auf Android, dass Bibliotheken redundant eingebunden werden oder auf IOS Header-Dateien mit nicht ASCII-konformen Anf&#xFC;hrungszeichen. Zus&#xE4;tzlich erzeugt der Babel-Compiler Probleme, da er nicht mit bereits vorkompilierten Dependencies arbeiten kann und nur mit JavaScript-Code best&#xFC;ckt werden kann. Erst im Rahmen der Realisierung eines Push-Service stellte sich endg&#xFC;ltig heraus, dass der Gedanke, die Apps nach einem Expo eject selbst zu kompilieren oder &#xFC;ber Expo auf den Store stellen zu lassen und nicht &#xFC;ber den Expo-Container zur Verf&#xFC;gung zu stellen, nicht realisierbar ist, und das unbh&#xE4;ngig davon, ob die Expo-Bibliotheken verwendet werden. Somit l&#xE4;uft die App nur innerhalb des Expo-Containers. Es war auf andere Weise nicht m&#xF6;glich, Push-Dienste zu realisieren, weil sie auf IOS nur funktionieren k&#xF6;nnen, wenn ein Entwicklerkonto zur Verf&#xFC;gung steht, ansonsten schl&#xE4;gt eine Authentifzierung fehl. Auf Android m&#xFC;sste Firebase genutzt werden, ein verf&#xFC;gbares Android-Ger&#xE4;t war jedoch veraltet und konnte nicht f&#xFC;r den Test verwendet werden. Emulatoren haben das Problem, dass Push-Dienste sie nicht unterst&#xFC;tzen.</p>
<h3 class="mume-header" id="72-a-namedas-entry-skriptadas-entry-skript">7.2. <a name="Das-Entry-Skript" href=""></a>Das-Entry-Skript</h3>

<p>Wird die App gestartet, muss zun&#xE4;chst ein Entry-Point festgelegt werden. Dieser findet sich in der Datei <code>App.js</code>. In dieser Datei wird zun&#xE4;chst der Navigationsbaum der App erstellt. Dieser Navigationsbaum ist ein SwitchNavigator, der als AppContainter bezeichnet wird. Anschlie&#xDF;end ist sie daf&#xFC;r zust&#xE4;ndig, festzustellen, ob im Speicher bereits Anmeldedaten vorhanden sind. Dies wird &#xFC;ber den Konstruktor realisiert. Nachdem der Speicher nach vorhandenen Logindaten abgepr&#xFC;ft wurde, wird die App gestartet. Dies geschieht, indem die Render-Funktion mit dem Befehl <code>return &lt;Appcontainer /&gt;</code> aufgerufen wird. Der Appcontainer initialisiert nun automatisch die Startseite. Diese wird durch den Konstruktor ausgew&#xE4;hlt, jenachdem, ob der Speicher abgerufen werden konnte und die Daten erfolgreich mit dem Server abgeglichen werden konnten. Bei Erfolg wird die Datei <code>Secured.js</code> geladen, bei Misserfolg die Datei <code>HomeScreen.js</code>.</p>
<h3 class="mume-header" id="73-a-namederhomescreenader-homescreen">7.3. <a name="DerHomeScreen" href=""></a>Der HomeScreen</h3>

<p>Dies ist die &#xFC;bliche Startseite, sie besteht aus einem Willkommenstext und einem Button, der die Seite <code>Login.js</code> aufruft. Wird die App zum ersten Mal gestartet, ist dies die erste Seite, die der User sieht. Sie enth&#xE4;lt einen kleinen Willkommenstext und f&#xFC;r Debuggingzwecke noch einen auskommentierten Slider, mit dem man mehrere andere Seiten direkt ansteuern kann.</p>
<h3 class="mume-header" id="74-a-namedielogin-pageadie-login-page">7.4. <a name="DieLogin-Page" href=""></a>Die Login-Page</h3>

<p>Die Loginseite beinhaltet die umfangreichste Funktionalit&#xE4;t. Hier sind zun&#xE4;chst zwei TextInput-Felder hinterlegt, die zwei Statusvariablen des Objekts bzw. der Seite beschreiben. Die TextInputs l&#xF6;sen bei Texteingabe hierzu jeweils Ereignisse aus, die den Usernamen und das Passwort beschreiben, wobei der Benutzername der Kundennummer in der Tabelle <code>kunde</code> entspricht. Dies war zun&#xE4;chst sehr buganf&#xE4;llig, bis die richtigen Events gefunden wurden, die die Textaktualisierungen erm&#xF6;glichen. Zus&#xE4;tzlich gibt es einen Button, der die gesamte Funktionalit&#xE4;t ausl&#xF6;st. Wird dieser geklickt, werden zun&#xE4;chst der eingegebene Username und das Passwort an den Server weitergeleitet, der eine Session in der Tabelle <code>appsession</code> generiert. Wurde die Kombination aus Username und Passwort nicht gefunden, wird vom Backend kein Sessionkey generiert. Dies erkennt die App und l&#xF6;st die Funktion <code>shake()</code>in den Input-Boxen aus, was dem User deutlich zu erkennen gibt, dass seine Eingaben falsch waren. Die Funktionalit&#xE4;t des Sch&#xFC;ttelns konnte erst realisiert werden, in dem das Framework &apos;react-native-elements&apos; eingebunden wurde. Wurde die Kombination jedoch in der Datenbakn gefunden, wird der Session-Key an die App weitergereicht und dort im Key-Storage gespeichert. Anschlie&#xDF;end wird ein Push-Token an das Backend &#xFC;bermittelt, mit dem sich die App beim Backend f&#xFC;r Push-Notifications registriert. War dies erfolgreich, wird nun die Seite <code>Secured.js</code> ge&#xF6;ffnet.</p>
<h3 class="mume-header" id="75-a-namederhomescreenfrangemeldeteuserader-homescreen-f%C3%BCr-angemeldete-user">7.5. <a name="DerHomescreenfrangemeldeteUser" href=""></a>Der Homescreen f&#xFC;r angemeldete User</h3>

<p>Dieses Fenster wird aufgerufen, wenn der Login mit SessionKey und mit Kundennummer erfolgreich war. Das bedeutet, dass entweder <code>App.js</code> oder <code>Login.js</code> erfolgreich sichergestellt haben, dass der UserID und der SessionKey in der App gespeichert sind. Diese Daten werden nun noch einmal aus dem Speicher abgerufen, um die Stammdaten des Users vom Backend zu erhalten. Die Stammdaten sind aktuell lediglich Vorname und Name. Nachdem die Stammdaten erfolgreich vom Server bezogen wurden, sieht dieser nun sein Begr&#xFC;&#xDF;ungsfenster. Er wird direkt in der &#xDC;bersicht mit seinem Namen begr&#xFC;&#xDF;t, sieht auch seine Kundennummer und Ausschnitte aus seiner Ger&#xE4;te-ID f&#xFC;r den Pushdienst sowie einen Teil des 1024 Zeichen langen Session-Keys. Die Funktionalit&#xE4;t dieser Seite besteht aus zwei Buttons: Ersterer ist ein Logout-Button, der dem Backend einen L&#xF6;schauftrag f&#xFC;r die Session &#xFC;bergibt und den User auf die Seite <code>HomeScreen.js</code>zur&#xFC;ckf&#xFC;hrt. Der andere Button leitet den User an die Seite <code>Scanner.js</code> weiter, in der er sein Shared Secret abrufen kann.</p>
<h3 class="mume-header" id="76-a-namebereitstellungeinessharedsecretbereinenqr-code-scannerabereitstellung-eines-shared-secret-%C3%BCber-einen-qr-code-scanner">7.6. <a name="BereitstellungeinesSharedSecretbereinenQR-Code-Scanner" href=""></a>Bereitstellung eines Shared Secret &#xFC;ber einen QR-Code-Scanner</h3>

<p>Die Zielsetzung der App hatte zun&#xE4;chst nur die Zielsetzung, Informationen &#xFC;ber Zahlungen und Buchungen innerhalb des Online-Bankings zur Verf&#xFC;gung zu stellen. Hierzu wurden Push-Notifications eingerichtet. Durch die Push-Notifications ist es nun m&#xF6;glich, diese Zahlungen in Form eines Strings innerhalb einer Push-Benachrichtigung auf dem Handy des Users nahezu in Echtzeit anzuzeigen. Als weitere M&#xF6;glichkeit wurde der Gedanke offengehalten, dass der User auf eine solche Benachrichtigung klicken kann und dadurch auf diese antwortet und mit dieser Antwort autorisiert. F&#xFC;r die Autorisierung sollte ein Shared Secret eingesetzt werden, dass nie direkt vom Backend an das Handy oder an den User versendet wird. Es wird in Form eines QR-Codes auf dem Computer angezeigt, den der Benutzer manuell einscannen muss. Zus&#xE4;tzlich sollte dieses Secret mit AES verschl&#xFC;sselt werden. Da Verschl&#xFC;sselung jedoch weder von Expo noch von React Native unterst&#xFC;tzt werden, musste dies unterbleiben (Die Bibliotheken konnten zwar bei Verwendung des Plattformspezifischen Compilers eingebunden werden, wurden aber aufgrund von mehreren Fehlermeldungen nicht kompiliert). Somit wird das Secret nun als unverschl&#xFC;sselter QR-Code im Backend erzeugt, als BASE64-String in die Datei <code>certificate.php</code> eingebunden und anschlie&#xDF;end auf dem Web-Frontend pr&#xE4;sentiert. Hat der User diesen Schritt durchgef&#xFC;hrt, muss er ihn nun auf dem Handy einscannen. Dort wird er anschlie&#xDF;end automatisch eingespeichert. Diese Funktionalit&#xE4;t f&#xFC;hrt das Skript <code>Scanner.js</code> durch. Es nutzt hierbei Expos BarcodeScanner. Die Seite nutzt folgende Methodik: Sie besteht aus zwei Objekten, einem Button, um zur&#xFC;ckzukehren und einem Kamerafenster. Das Kamerafenster wird zun&#xE4;chst blockiert, weil die Berechtigung abgefragt wird. Ist die Berechtigung gegeben, kann der User nun den QR-Code einscannen. &#xDC;ber den Zur&#xFC;ck-Button kann er den gesamten Vorgang abbrechen und zu <code>Secured.js</code> zur&#xFC;ckkehren. Ansonsten kann er einen Code einscannen, der im Folgenden im Secure Storage eingespeichert wird, diesen Vorgang f&#xFC;hrt die Funktion <code>processBarcode()</code> durch. An deren Ende erscheint automatisch wieder die Secured-Page.</p>
<h3 class="mume-header" id="77-a-namedieergnzendenskripteadie-erg%C3%A4nzenden-skripte">7.7. <a name="DieergnzendenSkripte" href=""></a>Die erg&#xE4;nzenden Skripte</h3>

<p>F&#xFC;r die Kommunikation mit dem Speicher der App sowie mit dem Backend wurden zwei weitere Skripte angelegt, die die hierf&#xFC;r n&#xF6;tigen Funktionen bereitstellen. Das Skript <code>Communication.js</code> stellt die Dienste bereit, um die Kommunikation mit dem Backend, um genau zu sein mit der Adresse <a href="https://fhwswebbankingapp.ddns.net/appdaemon.php">https://fhwswebbankingapp.ddns.net/appdaemon.php</a> zu erm&#xF6;glichen. Drei unktionen sind f&#xFC;r das Management der Session zust&#xE4;ndig, die Funktion <code>getUserMasterData()</code> bezieht Stammdaten vom Backend und die Funktion <code>registerForPushNotificationsAsync()</code> aktiviert die Push-Benachrichtigungen. Diese Funktionen nutzen die fetch()-API und sind daher ausnahmslos asynchron. Sie m&#xFC;ssen dementsprechend Beachtung daf&#xFC;r finden, dass ihre Ergebnisse erst abgefragt werden, nachdem das sogenannte Promise aufgel&#xF6;st wurde.<br>
Das zweite Skript <code>Storage.js</code> steuert die Zugriffe auf den lokalen Speicher der App. Auch diese Funktionen sind asynchron. Sowohl bei IOS als auch bei Android handelt es sich hierbei um einen verschl&#xFC;sselten Speicher. Dies ist im Fall der App von hoher Relevanz, da signifikante Daten wie der Sessionkey und die Kundennummer Zugriffe auf die Daten des Users erm&#xF6;glichen k&#xF6;nnen. Die beiden genannten Skripte nutzen mehrere Funktionen aus dem Expo-Framework und erfordern daher dass dieses eingesetzt wird. Somit sind sie f&#xFC;r reines React Native nicht verwendbar.<br>
Das dritte Skript, dass der Unterst&#xFC;ztung aller App-Komponenten dient, ist das Stylesheet mit dem Namen <code>MyStyleSheet.js</code>. Bei diesem Stylesheet erscheint verwunderlich, dass es nicht im <code>.css</code>-Format gespeichert wurde. Der Grund hierf&#xFC;r ist jedoch, dass bei React und dem darauf basierenden React Native, keine andere Sprache als JavaScript verwendet wird. Daher wird der CSS-Code zwar fast genauso wie ein &#xFC;bliches CSS verfasst, wird am Ende jedoch in eine JavaScript-Funktion gekapselt. Dies ist die Funktion <code>StyleSheet.create({})</code>, in deren innneren der CSS-Code steht.</p>
<h3 class="mume-header" id="78-a-namestartderappastart-der-app">7.8. <a name="StartderApp" href=""></a>Start der App</h3>

<p>Der Start der App ist denkbar einfach. Zun&#xE4;chst einmal muss der User Expo auf sein Mobilger&#xE4;t herunterladen. Anschlie&#xDF;end muss er lediglich noch den Deployment-Link beziehen. M&#xF6;chte der User auf den Code zugreifen, dann ist der Weg etwas umfangreicher, da er zun&#xE4;chst noch &apos;expo&apos; und &apos;expo-cli&apos; herunterladen muss. Hierzu wird Node.js sowie die zugeh&#xF6;rige Paketverwaltung npm ben&#xF6;tigt. Dort m&#xFC;ssen zun&#xE4;chst alle Dependencies heruntergeladen werden. Anschlie&#xDF;end kann der User <code>$ expo start</code> in seiner Konsole ausf&#xFC;hren, was ihn durch den Prozess der Installation auf dem Handy begleitet. Eine ausf&#xFC;hrlichere Installationsanleitung sowie der vom Entwicklerteam generierte Deployment-Link befinden sich in der Readme-Datei des Mobile-App-Projektordners.</p>
<h2 class="mume-header" id="8-a-namefunotenafu%C3%9Fnoten">8. <a name="Funoten" href=""></a>Fu&#xDF;noten</h2>

<p><a name="quelleZuPear" href="">1</a>: Cimpanu, Catalin. Mystery still surrounds hack of PHP PEAR website | ZDNet. <a href="https://www.zdnet.com/article/mystery-still-surrounds-hack-of-php-pear-website/">https://www.zdnet.com/article/mystery-still-surrounds-hack-of-php-pear-website/</a>. Zugegriffen: 6. Februar 2019.<br>
<a name="HTTP_StatusCodes" href="">2</a>: HTTP/1.1: Status Code Definitions. 2004. <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a>. Zugegriffen: 6. Februar 2019.</p>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>